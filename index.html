<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="theme-color" content="#0f766e" />
  <title>KC868 Wi-Fi Setup</title>
  <link rel="manifest" href="./manifest.webmanifest" />
  <link rel="stylesheet" href="./styles.css" />
</head>
<body>
  <main class="app">
    <header class="hero">
      <p class="kicker">KINCONY KC868-A6-V1 4SP</p>
      <h1>Configuração Wi-Fi via Bluetooth</h1>
      <p class="subtitle">PWA para provisionar SSID/senha e validar conexão da placa.</p>
    </header>

    <section class="card">
      <div class="row">
        <button id="connectBtn" type="button">Conectar Bluetooth</button>
        <button id="statusBtn" type="button" disabled>Atualizar Status</button>
        <button id="unpairBtn" type="button" class="secondary" disabled>Desparear Bluetooth</button>
      </div>
      <p id="bleState" class="state">Desconectado</p>
      <p id="loadingBox" class="loading hidden"></p>
      <p class="hint">Passkey BLE: <strong>123456</strong></p>
      <p id="wifiAlert" class="alert hidden"></p>
    </section>

    <section class="card">
      <h2>Wi-Fi</h2>

      <div id="wifiConfiguredBox" class="hidden">
        <p class="wifi-label">Rede ativa/configurada:</p>
        <p id="configuredSsid" class="ssid-pill">-</p>
        <div class="row">
          <button id="clearBtn" type="button" class="secondary" disabled>Limpar Configuração</button>
        </div>
      </div>

      <div id="wifiConfigBox">
        <form id="wifiForm">
          <label for="ssid">SSID</label>
          <input id="ssid" name="ssid" required maxlength="64" autocomplete="off" />

          <label for="password">Senha</label>
          <input id="password" name="password" type="password" maxlength="64" />

          <div class="row">
            <button id="saveBtn" type="submit" disabled>Salvar e Conectar</button>
          </div>
        </form>
      </div>
    </section>

    <section class="card">
      <h2>Relés</h2>
      <p id="relayInfo" class="hint">Aguardando status da placa...</p>
      <div id="relayGrid" class="relay-grid">
        <div class="relay-item">
          <span>Relé 1</span>
          <button type="button" data-relay="1" class="relay-btn" disabled>Desligado</button>
        </div>
        <div class="relay-item">
          <span>Relé 2</span>
          <button type="button" data-relay="2" class="relay-btn" disabled>Desligado</button>
        </div>
        <div class="relay-item">
          <span>Relé 3</span>
          <button type="button" data-relay="3" class="relay-btn" disabled>Desligado</button>
        </div>
        <div class="relay-item">
          <span>Relé 4</span>
          <button type="button" data-relay="4" class="relay-btn" disabled>Desligado</button>
        </div>
        <div class="relay-item">
          <span>Relé 5</span>
          <button type="button" data-relay="5" class="relay-btn" disabled>Desligado</button>
        </div>
        <div class="relay-item">
          <span>Relé 6</span>
          <button type="button" data-relay="6" class="relay-btn" disabled>Desligado</button>
        </div>
      </div>
    </section>

    <section class="card">
      <h2>Último Status</h2>
      <pre id="statusBox">Sem dados</pre>
    </section>

    <section class="card">
      <h2>Log BLE</h2>
      <pre id="logBox"></pre>
    </section>
  </main>
  <script src="./app.js" type="module"></script>
</body>
</html>
